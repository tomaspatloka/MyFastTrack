<!DOCTYPE html>
<html>
<head>
    <title>Generate PWA Icons</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 40px; background: #1a1a2e; color: white; }
        .container { max-width: 600px; margin: 0 auto; text-align: center; }
        h1 { color: #69f0ae; }
        .preview { margin: 20px 0; }
        .preview img { border: 2px solid #333; border-radius: 20px; margin: 10px; }
        button { background: #69f0ae; color: #000; border: none; padding: 15px 30px;
                 font-size: 16px; border-radius: 8px; cursor: pointer; margin: 10px; }
        button:hover { background: #00e676; }
        canvas { display: none; }
        .sizes { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin: 20px 0; }
        .size-item { text-align: center; }
        .size-item img { display: block; margin: 0 auto 5px; }
        .instructions { background: #2a2a4e; padding: 20px; border-radius: 10px; margin-top: 30px; text-align: left; }
        .instructions ol { padding-left: 20px; }
        .instructions code { background: #1a1a2e; padding: 2px 6px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>MyFastTrack Icon Generator</h1>
        <p>Generate PNG icons from SVG for PWA installation</p>

        <div class="sizes" id="previews"></div>

        <button onclick="downloadAll()">Download All Icons</button>

        <canvas id="canvas"></canvas>

        <div class="instructions">
            <h3>Instructions:</h3>
            <ol>
                <li>Click "Download All Icons" to get the PNG files</li>
                <li>Replace the existing <code>icon.png</code> with the 512x512 version</li>
                <li>Optionally add smaller sizes to manifest.json</li>
            </ol>
        </div>
    </div>

    <script>
        const sizes = [512, 384, 256, 192, 144, 96, 72, 48];
        const svgUrl = 'icon.svg';

        async function loadSVG() {
            const response = await fetch(svgUrl);
            const svgText = await response.text();
            return svgText;
        }

        async function generateIcon(size) {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = size;
            canvas.height = size;

            const img = new Image();
            const svgBlob = new Blob([await loadSVG()], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(svgBlob);

            return new Promise((resolve) => {
                img.onload = () => {
                    ctx.clearRect(0, 0, size, size);
                    ctx.drawImage(img, 0, 0, size, size);
                    URL.revokeObjectURL(url);
                    resolve(canvas.toDataURL('image/png'));
                };
                img.src = url;
            });
        }

        async function showPreviews() {
            const container = document.getElementById('previews');
            for (const size of sizes) {
                const dataUrl = await generateIcon(size);
                const div = document.createElement('div');
                div.className = 'size-item';
                div.innerHTML = `
                    <img src="${dataUrl}" width="${Math.min(size, 128)}" height="${Math.min(size, 128)}">
                    <small>${size}x${size}</small>
                `;
                container.appendChild(div);
            }
        }

        async function downloadAll() {
            for (const size of sizes) {
                const dataUrl = await generateIcon(size);
                const a = document.createElement('a');
                a.href = dataUrl;
                a.download = `icon-${size}.png`;
                a.click();
                await new Promise(r => setTimeout(r, 200));
            }
        }

        showPreviews();
    </script>
</body>
</html>